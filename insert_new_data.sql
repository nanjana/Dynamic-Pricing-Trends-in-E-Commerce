-- CS779 Advanced DBMS Term Project --- 
-- Anjana Nittur -- 
-- This code file is about insertion of new data and verify how the code works for newly inserted data
select * from sales;

INSERT INTO sales (product_id, user_id, seller_id, order_id, price, quantity, shipping_price, total_price, time_id)
VALUES 
    -- Entries for time_id = 1 (2024-01-03)
    (1001051, 500051, 61, 700051, 65.00, 3, 5.00, 200.00, 1),
    (1001052, 500052, 62, 700052, 75.99, 2, 6.00, 157.98, 1),
    (1001053, 500053, 63, 700053, 95.00, 1, 4.50, 99.50, 1),
    
    -- Entries for time_id = 2 (2019-11-25)
    (1001054, 500054, 64, 700054, 50.00, 5, 8.00, 258.00, 2),
    (1001055, 500055, 65, 700055, 85.99, 3, 7.00, 265.97, 2),
    (1001056, 500056, 66, 700056, 120.00, 4, 10.00, 490.00, 2),
    
    -- Entries for time_id = 3 (2024-11-28)
    (1001057, 500057, 67, 700057, 35.50, 2, 2.50, 73.50, 3),
    (1001058, 500058, 68, 700058, 45.99, 1, 3.00, 48.99, 3),
    (1001059, 500059, 69, 700059, 75.00, 2, 6.00, 156.00, 3),
    (1001060, 500060, 70, 700060, 100.00, 3, 9.00, 309.00, 3),
    (1001061, 500061, 71, 700061, 55.00, 4, 7.50, 227.50, 3),
    (1001062, 500062, 72, 700062, 85.50, 2, 5.00, 176.00, 3),
    (1001063, 500063, 73, 700063, 35.00, 3, 5.50, 110.50, 3),
    (1001064, 500064, 74, 700064, 45.00, 1, 3.00, 48.00, 3),
    (1001065, 500065, 75, 700065, 25.00, 5, 6.00, 131.00, 3),
    (1001066, 500066, 76, 700066, 50.00, 2, 4.00, 104.00, 3),
    (1001067, 500067, 77, 700067, 75.50, 3, 8.00, 234.50, 3),
    (1001068, 500068, 78, 700068, 90.00, 4, 7.50, 367.50, 3),
    (1001069, 500069, 79, 700069, 85.99, 2, 9.00, 180.98, 3),
    (1001070, 500070, 80, 700070, 65.00, 3, 5.00, 200.00, 3),
    (1001071, 500071, 81, 700071, 125.00, 1, 10.00, 135.00, 3),
    (1001072, 500072, 82, 700072, 45.99, 4, 3.00, 187.96, 3),
    (1001073, 500073, 83, 700073, 50.00, 5, 6.00, 256.00, 3),
    (1001074, 500074, 84, 700074, 35.50, 2, 2.50, 73.50, 3),
    (1001075, 500075, 85, 700075, 95.99, 3, 8.00, 303.97, 3),
    (1001076, 500076, 86, 700076, 85.00, 4, 9.00, 349.00, 3),
    (1001077, 500077, 87, 700077, 60.50, 2, 4.50, 125.50, 3),
    (1001078, 500078, 88, 700078, 75.00, 1, 5.00, 80.00, 3),
    (1001079, 500079, 89, 700079, 125.00, 5, 10.00, 635.00, 3),
    (1001080, 500080, 90, 700080, 55.00, 3, 7.50, 172.50, 3);

-- Test during presentation
INSERT INTO sales (product_id, user_id, seller_id, order_id, price, quantity, shipping_price, total_price, time_id)
VALUES 
    -- Entries for time_id = 1 (2024-01-03)
    (1001081, 500081, 91, 700081, 42.00, 2, 3.00, 87.00, 1),
    (1001082, 500082, 92, 700082, 60.00, 1, 4.50, 64.50, 1),
    (1001083, 500083, 93, 700083, 80.00, 3, 7.00, 247.00, 1),
    
    -- Entries for time_id = 2 (2019-11-25)
    (1001084, 500084, 94, 700084, 30.00, 4, 5.00, 125.00, 2),
    (1001085, 500085, 95, 700085, 45.50, 2, 3.50, 94.50, 2),
    (1001086, 500086, 96, 700086, 110.00, 5, 8.50, 558.50, 2),
    
    -- Entries for time_id = 3 (2024-11-28)
    (1001087, 500087, 97, 700087, 70.00, 1, 4.00, 74.00, 3),
    (1001088, 500088, 98, 700088, 33.50, 3, 5.00, 105.50, 3),
    (1001089, 500089, 99, 700089, 95.00, 2, 6.50, 196.50, 3),
    (1001090, 500090, 100, 700090, 50.00, 5, 8.00, 258.00, 3),
    (1001091, 500091, 101, 700091, 85.99, 4, 7.50, 351.96, 3),
    (1001092, 500092, 102, 700092, 99.00, 1, 4.50, 103.50, 3),
    (1001093, 500093, 103, 700093, 35.00, 3, 5.50, 110.50, 3),
    (1001094, 500094, 104, 700094, 45.99, 2, 3.00, 94.98, 3),
    (1001095, 500095, 105, 700095, 75.00, 3, 6.00, 231.00, 3),
    (1001096, 500096, 106, 700096, 100.00, 2, 9.00, 209.00, 3),
    (1001097, 500097, 107, 700097, 60.50, 4, 7.00, 250.00, 3),
    (1001098, 500098, 108, 700098, 90.00, 3, 7.50, 277.50, 3),
    (1001099, 500099, 109, 700099, 25.00, 5, 6.50, 131.50, 3),
    (1001100, 500100, 110, 700100, 55.00, 4, 4.00, 224.00, 3),
    (1001101, 500101, 111, 700101, 45.50, 2, 5.00, 96.00, 3),
    (1001102, 500102, 112, 700102, 125.00, 3, 10.00, 385.00, 3),
    (1001103, 500103, 113, 700103, 35.50, 1, 2.50, 38.00, 3),
    (1001104, 500104, 114, 700104, 95.99, 2, 9.00, 200.98, 3),
    (1001105, 500105, 115, 700105, 50.00, 3, 7.00, 157.00, 3),
    (1001106, 500106, 116, 700106, 85.00, 4, 8.50, 348.00, 3),
    (1001107, 500107, 117, 700107, 60.50, 1, 4.00, 64.50, 3),
    (1001108, 500108, 118, 700108, 75.00, 3, 6.00, 231.00, 3),
    (1001109, 500109, 119, 700109, 55.00, 2, 3.50, 113.50, 3),
    (1001110, 500110, 120, 700110, 90.00, 1, 5.00, 95.00, 3);


CALL incremental_load_sales();

CALL validate_and_insert_sales();

CALL generate_daily_sales_summary();

CALL refresh_materialized_views();

SELECT * FROM intermediate_staging_data;
SELECT * FROM staging_ebay_data;
